# 聚类分析中的层次分析
## 📌一、项目简介
本项目展示了如何使用 层次聚类（Hierarchical Clustering） 方法对多通道信号数据进行分析与分组。  
主要流程包括：
1. 通过生成包含 高斯噪声和 50Hz 正弦波 的模拟信号，并提取其时域、频域和能量特征，利用 PCA 降维 和 层次聚类 进行信号分组。
2. 通过 树状图 和 二维可视化 展示，帮助我们理解不同通道信号之间的相似性。

---

## 二、运行方式
1. 安装依赖

首先，确保你的环境已安装所需的 Python 库。你可以通过以下命令安装依赖：
```
pip install numpy matplotlib scipy scikit-learn
```
2. 运行代码
```
python clustering_analysis.py
```
3. 查看结果
运行脚本后，聚类结果将通过 PCA 降维后的二维散点图 和 树状图 进行可视化，并输出每个信号通道的聚类标签。结果会显示在控制台以及弹出的可视化图中。
---
## 三、核心流程说明
1. 数据生成与特征提取

在实验中，创建了 10 个通道 的模拟信号数据，每个通道包含 1000 个采样点。信号是由 50Hz 正弦波和高斯噪声叠加 生成，并使用固定的随机种子确保可复现性。

  对于每个信号通道，提取以下几类特征：
  - 时域特征：包括均值、标准差、偏度、峭度、峰峰值和均方根值（RMS）。  
 - 频域特征：包括主频、频谱质心、带宽和频谱熵。  
- 能量特征：即信号的 dB 值，表示信号的功率强度。
2. 数据标准化与层次聚类

  所有提取的特征被存储在一个特征矩阵中，并通过 **StandardScaler** 进行标准化处理。
然后，使用 **层次聚类（Hierarchical Clustering）** 方法对标准化后的特征进行聚类分析。采用 **Ward method** 计算簇之间的距离，并通过 **fcluster** 切割聚类树，得到每个信号通道的聚类标签。  
3. PCA 降维与可视化

  为了便于可视化，使用 **PCA（主成分分析）** 将高维特征降到二维，并绘制散点图。每个点表示一个信号通道，点的颜色表示聚类标签（不同颜色代表不同簇）。
同时，绘制 **树状图（Dendrogram）**，展示层次聚类过程中不同簇的合并过程。  
4. 聚类结果输出

  最终，输出每个信号通道的聚类标签，表示其所属的簇，且会打印每个簇的 聚类中心，即簇中所有通道特征的平均值。
## 四、结果展示
  
  以下是程序运行的 可视化结果：
- **树状图（Dendrogram）** 展示了不同簇的合并过程。
- **PCA 降维后的散点图** 展示了各通道在二维空间中的分布，颜色代表不同的聚类簇。
